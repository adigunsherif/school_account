{% extends 'base.html' %}
{% load humanize %}


{% block title %}
   Account Statement
{% endblock title %}

{% block toolbar %}
<div class="btn-toolbar mb-2 mb-md-0">
    <button type="button" name="button" class="btn btn-sm btn-outline-secondary" id="generate-invoice">
      <span data-feather="download"></span>
      Download
    </button>
  </div>
{% endblock toolbar %}


{% block content %}

<form method="GET" class="form-inline mb-3">
    {% for field in search %}
        <div class="field-group mr-sm-2">
            {{field}}
        </div>

    {% endfor %}

    <button type="submit" class="btn btn-primary btn-sm">Search</button>
</form>




{% if bills %}

    <div class="row">
        <div class="col-sm-7">
            <div class="row">
                <div class="col-7 mb-2">
                    <div class="card">
                        <div class="card-body bg-primary text-white">
                            <h5 class="card-title">{{currency}} {{bill_totals.0 | intcomma}} </h5>
                            <p class="card-text">Total Expected Amount</p>
                        </div>
                    </div>
                </div>
                <div class="col-5 mb-2">
                    <div class="card">
                        <div class="card-body bg-success text-white">
                            <h5 class="card-title">{{currency}} {{bill_totals.1 | intcomma}}</h5>
                            <p class="card-text">Total Amount Paid</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-6">
                    <div class="card">
                        <div class="card-body bg-danger text-white">
                          <h5 class="card-title">{{currency}} {{bill_totals.2 | intcomma}}</h5>
                          <p class="card-text">Debts</p>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card">
                        <div class="card-body bg-secondary text-white">
                            <h5 class="card-title">{{currency}} {{bill_totals.3 | intcomma}}</h5>
                            <p class="card-text">Credit</p>
                        </div>
                        </div>
                </div>
            </div>
        </div>
        <div class="col-sm-5">
            <canvas id="myChart" width="400" height="200"></canvas>
        </div>
    </div>



    <div class="mt-3">
        <h4>Bill Items</h4>
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Value Total</th>
                    <th>Amount Paid</th>
                </tr>
            </thead>
            <tbody>

                {% for key,val in categories.items %}
                    <tr>
                        <td>{{key}}</td>
                        <td>{{currency}} {{val.0 | intcomma}}</td>
                        <td>{{currency}} {{val.1 | intcomma}}</td>
                    </tr>
                {% endfor %}

            </tbody>
        </table>
    </div>

    <div class="mt-3">
        <h4>Bank Detail</h4>
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Bank Name</th>
                    <th>Total Amount Paid</th>
                </tr>
            </thead>
            <tbody>

                {% for key,amount in banks.items %}
                    <tr>
                        <td>{{key}}</td>
                        <td>{{currency}} {{amount | intcomma}}</td>
                        <td></td>
                    </tr>
                {% endfor %}

            </tbody>
        </table>
    </div>
{% elif request.GET %}
    There are currently no item for your chosen query.
{% else %}
    Please select the filter and click search
{% endif %}



{% endblock content %}



{% block scripts %}
    <script>
        var ctx = document.getElementById('myChart')
        // eslint-disable-next-line no-unused-vars
        var myChart = new Chart(ctx, {
            type: 'pie',
            data: {
                datasets: [{
                    data: ["{{bill_totals.0}}", "{{bill_totals.1}}", "{{bill_totals.2}}", "{{bill_totals.3}}"],
                    backgroundColor: [
                        'blue',
                        'green',
                        'red',
                        'grey'
                    ]
                }],
                labels: [
                    'Expected',
                    'Paid',
                    'Debt',
                    'Credit',
                ]

            }
        })
    </script>
{% endblock scripts %}
